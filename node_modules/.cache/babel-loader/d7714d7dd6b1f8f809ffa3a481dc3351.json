{"ast":null,"code":"var _jsxFileName = \"/Users/kwong51/2021_spring/cmsc389nspring2021-kwong/assignments/semesterProject/FinalExam/FinalProjectImplementation/frontend/src/ItemPage.js\";\nimport React from \"react\";\nimport icon from \"./360_F_293396301_JCm1p815YEbh7ga75XOUuEsaDVlZ2O0C.jpg\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Item extends React.Component {\n  constructor(props) {\n    super(props);\n    this.stores = this.stores.bind(this);\n    this.history = this.history.bind(this);\n    this.subscribeButton = this.subscribeButton.bind(this);\n    this.updateData = this.updateData.bind(this);\n    this.getData = this.getData.bind(this);\n    this.updatesubscribeButton = this.updatesubscribeButton.bind(this);\n    this.state = {\n      name: \"Product not found\",\n      hisPrice: [],\n      price: 0,\n      email: \"\",\n      currStorePrice: -1,\n      storeOption: \"ebay\",\n      lowestHisPrice: -1,\n      hisOption: \"date_max\"\n    };\n  }\n\n  subscribeButton(e) {\n    e.preventDefault();\n\n    if (this.state.email.indexOf('@') === -1) {\n      document.getElementById(\"warn3\").innerHTML = \"Your email address is invalid. Please try again.\";\n    } else if (this.state.price < 0 || this.state.price === \"\") {\n      document.getElementById(\"warn3\").innerHTML = \"Price must be greater or equal to 0.\";\n    } else {\n      let data = {\n        item: this.state.name,\n        email: this.state.email,\n        desired_price: this.state.price\n      };\n      let options = {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      };\n      fetch('/track', options);\n      alert(\"Your notification has been successfully registered. Please check your email at \" + this.state.email);\n    }\n  }\n\n  updatesubscribeButton(e) {\n    e.preventDefault();\n\n    if (this.state.email.indexOf('@') === -1) {\n      document.getElementById(\"warn3\").innerHTML = \"Your email address is invalid. Please try again.\";\n    } else if (this.state.price < 0 || this.state.price === \"\") {\n      document.getElementById(\"warn3\").innerHTML = \"Price must be greater or equal to 0.\";\n    } else {\n      let data = {\n        item: this.state.name,\n        email: this.state.email,\n        desired_price: this.state.price\n      };\n      let options = {\n        method: 'put',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      };\n      fetch('/track', options).then(res => res.json()).then(data => {\n        if (data.success == true) {\n          alert(\"You has been successfully update watch price. Please check your email at \" + this.state.email);\n        } else {\n          alert(\"Fail to update, please check your email address\");\n        }\n      });\n    }\n  }\n\n  stores(e) {\n    let historyPrice = this.state.hisPrice;\n    const obj = historyPrice.reduce(function (prev, curr) {\n      return prev.date < curr.date ? prev : curr;\n    });\n    console.log(obj.price);\n    this.setState({\n      storeOption: e.currentTarget.value,\n      currStorePrice: obj.price\n    }); // document.getElementById(\"price\").innerHTML = \"$\" + this.state.currStorePrice;\n  }\n\n  history(e) {\n    let historyPrice = this.state.hisPrice;\n    const hisOption = this.state.hisOption;\n    const his = {\n      \"date_1w\": 7,\n      \"date_1m\": 30,\n      \"date_6m\": 30 * 6,\n      \"date_1y\": 365,\n      \"date_5y\": 365 * 5,\n      \"date_max\": Infinity\n    };\n    const now = new Date().getTime();\n    const opt = historyPrice.filter(curr => (now - curr.date) / (1000 * 3600 * 24) <= his[hisOption]);\n    console.log(typeof opt);\n    console.log(opt);\n    const lastPrice = opt.reduce(function (prev, curr) {\n      return prev.date < curr.date ? prev : curr;\n    });\n    this.setState({\n      hisOption: e.currentTarget.value,\n      lowestHisPrice: lastPrice.price\n    }); // document.getElementById(\"lowest\").innerHTML = \"$\" + this.state.lowestHisPrice;\n  }\n\n  handleChange(event) {\n    this.setState({\n      [event.target.name]: event.target.value\n    });\n  }\n\n  not_available(e) {\n    e.preventDefault();\n    alert(\"Sorry, this feature is not allowed at this time\");\n  }\n\n  getData() {\n    fetch('/product/' + this.state.name).then(res => res.json()).then(data => {\n      console.log(data);\n      this.setState(prevState => {\n        return {\n          hisPrice: data.info\n        };\n      });\n    });\n  }\n\n  updateData() {\n    let data = {\n      item: this.props.history.location.state.name\n    };\n    let options = {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    };\n    fetch('/product', options).then(res => res.json()).then(data => {\n      console.log(data.productName);\n      this.setState(prevState => {\n        return {\n          name: data.productName\n        };\n      });\n    });\n  }\n\n  async componentDidMount() {\n    let data = {\n      item: this.props.history.location.state.name\n    };\n    let options = {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    };\n    const resp = await fetch('/product', options);\n    const json = await resp.json();\n    this.setState({\n      name: json.productName\n    });\n    const resp_d = await fetch('https://kwong51backend.herokuapp.com/product/' + this.state.name);\n    const json_d = await resp_d.json();\n    this.setState({\n      hisPrice: json_d.info\n    });\n    let historyPrice = this.state.hisPrice;\n    const obj = historyPrice.reduce(function (prev, curr) {\n      return prev.date < curr.date ? prev : curr;\n    });\n    this.setState({\n      currStorePrice: obj.price\n    });\n    let history = this.state.hisPrice;\n    const hisOption = this.state.hisOption;\n    const his = {\n      \"date_1w\": 7,\n      \"date_1m\": 30,\n      \"date_6m\": 30 * 6,\n      \"date_1y\": 365,\n      \"date_5y\": 365 * 5,\n      \"date_max\": Infinity\n    };\n    const now = new Date().getTime();\n    const opt = history.filter(curr => (now - curr.date) / (1000 * 3600 * 24) <= his[hisOption]);\n    const lastPrice = opt.reduce(function (prev, curr) {\n      return prev.date < curr.date ? prev : curr;\n    });\n    this.setState({\n      lowestHisPrice: lastPrice.price\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"item\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"top\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          class: \"icon\",\n          src: icon\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/\",\n          children: \"Home\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          onClick: this.not_available,\n          children: \"Top Price drops\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          onClick: this.not_available,\n          children: \"Contact\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          onClick: this.not_available,\n          children: \"About\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"productt\",\n        children: this.state.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        class: \"selectstore\",\n        children: [\"The last available price:\", /*#__PURE__*/_jsxDEV(\"span\", {\n          id: \"price\",\n          children: [\"$\", this.state.currStorePrice]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 42\n        }, this), \" on:\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"allstore\",\n                checked: this.state.storeOption === \"allstore\",\n                onClick: this.stores\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 187,\n                columnNumber: 41\n              }, this), \"All platforms\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"amazon\",\n                onClick: this.not_available\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 188,\n                columnNumber: 41\n              }, this), \"Amazon\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"ebay\",\n                checked: this.state.storeOption === \"ebay\",\n                onClick: this.stores\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 41\n              }, this), \"Ebay\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"walmart\",\n                onClick: this.not_available\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 41\n              }, this), \"Walmart\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-sm\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"anystore\",\n                onClick: this.not_available\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 191,\n                columnNumber: 41\n              }, this), \"Any Third Party\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        class: \"date_range\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"lowestHis\",\n          children: [\"Lowest Price History:\", /*#__PURE__*/_jsxDEV(\"span\", {\n            id: \"lowest\",\n            children: [\"$\", this.state.lowestHisPrice]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 58\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 17\n        }, this), \" within Date Range:\", /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-md\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"date_1w\",\n                checked: this.state.hisOption === \"date_1w\",\n                onClick: this.history\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 200,\n                columnNumber: 37\n              }, this), \"1 week\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-md\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"date_1m\",\n                checked: this.state.hisOption === \"date_1m\",\n                onClick: this.history\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 201,\n                columnNumber: 41\n              }, this), \"1 month\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 201,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-md\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"date_6m\",\n                checked: this.state.hisOption === \"date_6m\",\n                onClick: this.history\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 202,\n                columnNumber: 41\n              }, this), \"6 months\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-md\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"date_1y\",\n                checked: this.state.hisOption === \"date_1y\",\n                onClick: this.history\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 41\n              }, this), \"1 year\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-md\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"date_5y\",\n                checked: this.state.hisOption === \"date_5y\",\n                onClick: this.history\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 204,\n                columnNumber: 41\n              }, this), \"5 years\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              class: \"col-md\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"radio\",\n                value: \"date_max\",\n                checked: this.state.hisOption === \"date_max\",\n                onClick: this.history\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 41\n              }, this), \"Max\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        id: \"pricewatch\",\n        onSubmit: e => {\n          this.subscribeButton(e);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"droptitle\",\n          children: \"Create Price Drop Notification\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Enter your email address below to receive emails as soon as this price becomes available.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          id: \"warn3\",\n          style: {\n            color: 'red'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 17\n        }, this), \"Send Emails to\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          name: \"email\",\n          placeholder: \"your email address\",\n          value: this.state.email,\n          onChange: e => {\n            this.handleChange(e);\n          },\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 17\n        }, this), \"when the Price Drops to $\", /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"number\",\n          name: \"price\",\n          value: this.state.price,\n          onChange: e => {\n            this.handleChange(e);\n          },\n          style: {\n            width: '4em'\n          },\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 18\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"submit\",\n          id: \"pricetrackButton\",\n          value: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"button\",\n          onClick: e => {\n            this.updatesubscribeButton(e);\n          },\n          value: \"update Price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Item;","map":{"version":3,"sources":["/Users/kwong51/2021_spring/cmsc389nspring2021-kwong/assignments/semesterProject/FinalExam/FinalProjectImplementation/frontend/src/ItemPage.js"],"names":["React","icon","Item","Component","constructor","props","stores","bind","history","subscribeButton","updateData","getData","updatesubscribeButton","state","name","hisPrice","price","email","currStorePrice","storeOption","lowestHisPrice","hisOption","e","preventDefault","indexOf","document","getElementById","innerHTML","data","item","desired_price","options","method","headers","body","JSON","stringify","fetch","alert","then","res","json","success","historyPrice","obj","reduce","prev","curr","date","console","log","setState","currentTarget","value","his","Infinity","now","Date","getTime","opt","filter","lastPrice","handleChange","event","target","not_available","prevState","info","location","productName","componentDidMount","resp","resp_d","json_d","render","color","width"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport icon from \"./360_F_293396301_JCm1p815YEbh7ga75XOUuEsaDVlZ2O0C.jpg\"\n\nclass Item extends React.Component  {\n    constructor(props) {\n        super(props);\n        this.stores = this.stores.bind(this)\n        this.history = this.history.bind(this)\n        this.subscribeButton = this.subscribeButton.bind(this)\n        this.updateData = this.updateData.bind(this)\n        this.getData = this.getData.bind(this)\n        this.updatesubscribeButton = this.updatesubscribeButton.bind(this)\n        this.state = {\n            name: \"Product not found\",\n            hisPrice: [],\n            price:0,\n            email:\"\",\n            currStorePrice: -1,\n            storeOption:\"ebay\",\n            lowestHisPrice: -1,\n            hisOption:\"date_max\",\n        };\n    }\n\n    subscribeButton(e){\n        e.preventDefault();\n        if (this.state.email.indexOf('@') === -1) {\n            document.getElementById(\"warn3\").innerHTML = \"Your email address is invalid. Please try again.\";\n        }\n        else if (this.state.price < 0 || this.state.price === \"\") {\n            document.getElementById(\"warn3\").innerHTML = \"Price must be greater or equal to 0.\";\n        }\n        else {\n            let data = {item: this.state.name, email: this.state.email, desired_price: this.state.price}\n            let options ={\n                method: 'post',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(data)\n              }\n            fetch('/track', options);\n            alert(\"Your notification has been successfully registered. Please check your email at \" + this.state.email);\n        }\n    }\n\n    updatesubscribeButton(e){\n        e.preventDefault();\n        if (this.state.email.indexOf('@') === -1) {\n            document.getElementById(\"warn3\").innerHTML = \"Your email address is invalid. Please try again.\";\n        }\n        else if (this.state.price < 0 || this.state.price === \"\") {\n            document.getElementById(\"warn3\").innerHTML = \"Price must be greater or equal to 0.\";\n        }\n        else {\n            let data = {item: this.state.name, email: this.state.email, desired_price: this.state.price}\n            let options ={\n                method: 'put',\n                headers: {\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify(data)\n              }\n            fetch('/track', options).then(res=>res.json())\n            .then(data=> {if (data.success==true) {alert(\"You has been successfully update watch price. Please check your email at \" + this.state.email)} else {alert(\"Fail to update, please check your email address\")}} )\n            \n        }\n    }\n\n    stores(e){        \n        let historyPrice = this.state.hisPrice\n        const obj = historyPrice.reduce(function(prev, curr) {return prev.date < curr.date ? prev : curr;});\n        console.log(obj.price)\n        this.setState({\n            storeOption: e.currentTarget.value,\n            currStorePrice: obj.price\n        })\n        // document.getElementById(\"price\").innerHTML = \"$\" + this.state.currStorePrice;\n    }\n\n\n    history(e){\n        let historyPrice = this.state.hisPrice\n        const hisOption = this.state.hisOption\n        const his = {\"date_1w\":7,\"date_1m\":30,\"date_6m\":30*6,\"date_1y\":365,\"date_5y\":365*5,\"date_max\": Infinity};\n        const now = new Date().getTime();\n        \n        const opt = historyPrice.filter(curr => (now-curr.date)/(1000*3600*24) <= his[hisOption])\n        console.log(typeof(opt))\n        console.log((opt))\n        const lastPrice = opt.reduce(function(prev, curr) {return prev.date < curr.date ? prev : curr;});\n        \n        this.setState({\n            hisOption: e.currentTarget.value,\n            lowestHisPrice: lastPrice.price\n            });\n        // document.getElementById(\"lowest\").innerHTML = \"$\" + this.state.lowestHisPrice;\n    }\n\n\n    handleChange(event) {\n        this.setState({ [event.target.name]: event.target.value });\n    }\n\n    not_available(e) {\n        e.preventDefault();\n        alert(\"Sorry, this feature is not allowed at this time\")\n    }\n\n    getData() {\n        fetch('/product/'+this.state.name)\n        .then(res => res.json())\n        .then(data => {console.log(data);\n        this.setState(\n          (prevState) => { return { hisPrice: data.info} }\n        )\n        })\n    }\n\n    updateData(){\n        let data = {item: this.props.history.location.state.name}\n        let options ={\n          method: 'post',\n          headers: {\n            'Content-Type': 'application/json'\n          }\n          ,body: JSON.stringify(data)\n        }\n        fetch('/product', options).then(res=>res.json())\n        .then(data=>{console.log(data.productName); this.setState((prevState)=>{ return { name: data.productName}})})\n    }\n\n    async componentDidMount(){\n        let data = {item: this.props.history.location.state.name}\n        let options ={\n          method: 'post',\n          headers: {\n            'Content-Type':'application/json'\n          }\n          ,body: JSON.stringify(data)\n        }\n            const resp = await fetch('/product', options)\n            const json = await resp.json();\n            this.setState({ name: json.productName});\n\n            const resp_d = await fetch('https://kwong51backend.herokuapp.com/product/'+this.state.name)\n            const json_d = await resp_d.json();\n            this.setState({hisPrice: json_d.info});\n\n            let historyPrice = this.state.hisPrice\n            const obj = historyPrice.reduce(function(prev, curr) {return prev.date < curr.date ? prev : curr;});\n            this.setState({\n                currStorePrice: obj.price\n            })\n\n\n            let history = this.state.hisPrice\n            const hisOption = this.state.hisOption\n            const his = {\"date_1w\":7,\"date_1m\":30,\"date_6m\":30*6,\"date_1y\":365,\"date_5y\":365*5,\"date_max\": Infinity};\n            const now = new Date().getTime();\n            const opt = history.filter(curr => (now-curr.date)/(1000*3600*24) <= his[hisOption])\n            const lastPrice = opt.reduce(function(prev, curr) {return prev.date < curr.date ? prev : curr;});\n            this.setState({\n                lowestHisPrice: lastPrice.price\n            });\n    }\n\n\n    render(){\n        return (\n            <div class=\"item\">\n            <div class=\"top\">\n            <img class=\"icon\" src={icon}></img>\n              <a href=\"/\">Home</a>\n              <a onClick={this.not_available}>Top Price drops</a>\n              <a onClick={this.not_available}>Contact</a>\n              <a onClick={this.not_available}>About</a>\n            </div>\n            <br />\n\n            <div id=\"productt\">{this.state.name}</div>\n            <form class=\"selectstore\">\n                The last available price:<span id=\"price\">${this.state.currStorePrice}</span> on:\n                <br />\n                <div class=\"container\">\n                <div class=\"row\">\n                    <div class=\"col-sm\"><input type=\"radio\" value=\"allstore\" checked={this.state.storeOption===\"allstore\"} onClick={this.stores} />All platforms</div>\n                    <div class=\"col-sm\"><input type=\"radio\" value=\"amazon\" onClick={this.not_available} />Amazon</div>\n                    <div class=\"col-sm\"><input type=\"radio\" value=\"ebay\" checked={this.state.storeOption===\"ebay\"} onClick={this.stores} />Ebay</div>\n                    <div class=\"col-sm\"><input type=\"radio\" value=\"walmart\" onClick={this.not_available} />Walmart</div>\n                    <div class=\"col-sm\"><input type=\"radio\" value=\"anystore\" onClick={this.not_available} />Any Third Party</div>\n                </div>\n                </div>\n            </form>\n\n            <form class=\"date_range\">\n                <div id=\"lowestHis\">Lowest Price History:<span id=\"lowest\">${this.state.lowestHisPrice}</span></div> within Date Range:\n                <div class=\"container\">\n                <div class=\"row\">\n                <div class=\"col-md\"><input type=\"radio\" value=\"date_1w\" checked={this.state.hisOption===\"date_1w\"} onClick={this.history} />1 week</div>\n                    <div class=\"col-md\"><input type=\"radio\" value=\"date_1m\" checked={this.state.hisOption===\"date_1m\"} onClick={this.history} />1 month</div>\n                    <div class=\"col-md\"><input type=\"radio\" value=\"date_6m\" checked={this.state.hisOption===\"date_6m\"} onClick={this.history} />6 months</div>\n                    <div class=\"col-md\"><input type=\"radio\" value=\"date_1y\" checked={this.state.hisOption===\"date_1y\"} onClick={this.history} />1 year</div>\n                    <div class=\"col-md\"><input type=\"radio\" value=\"date_5y\" checked={this.state.hisOption===\"date_5y\"} onClick={this.history} />5 years</div>\n                    <div class=\"col-md\"><input type=\"radio\" value=\"date_max\" checked={this.state.hisOption===\"date_max\"} onClick={this.history} />Max</div>\n                </div>\n                </div>\n                <br />\n            </form>\n\n            <form id=\"pricewatch\" onSubmit={(e)=>{this.subscribeButton(e)}}>\n                <div class=\"droptitle\">Create Price Drop Notification</div>\n                <p>Enter your email address below to receive emails as soon as this price becomes available.</p>\n                <p id=\"warn3\" style={{color:'red'}} />\n                Send Emails to \n                <input type=\"email\" name=\"email\" placeholder=\"your email address\" value={this.state.email} onChange={(e)=>{this.handleChange(e)}} required />\n                 when the Price Drops to\n                $<input type=\"number\" name=\"price\" value={this.state.price} onChange={(e)=>{this.handleChange(e)}} style={{width:'4em'}} required />\n                <input type=\"submit\" id=\"pricetrackButton\" value=\"Submit\" />\n                <input type=\"button\" onClick= {(e)=>{this.updatesubscribeButton(e)}} value=\"update Price\"/>\n            </form>\n            </div>\n        );\n    }\n}\n\nexport default Item;"]},"metadata":{},"sourceType":"module"}